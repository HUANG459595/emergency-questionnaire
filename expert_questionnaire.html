<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>区域应急科普能力评价体系权重专家打分问卷</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 24px;
        }
        
        h2 {
            color: #34495e;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 18px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        h3 {
            color: #7f8c8d;
            margin-top: 20px;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .instructions {
            background-color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .instructions p {
            margin-bottom: 10px;
        }
        
        .scale-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: #f8f9fa;
        }
        
        .scale-table th,
        .scale-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }
        
        .scale-table th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        
        .matrix-container {
            margin: 30px 0;
            overflow-x: auto;
        }
        
        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .matrix-table th,
        .matrix-table td {
            border: 1px solid #ddd;
            padding: 15px;
            text-align: center;
            min-width: 120px;
        }
        
        .matrix-table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        
        .matrix-table input {
            width: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
        }
        
        .matrix-table input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .fixed-value {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        
        .info-section {
            margin: 30px 0;
        }
        
        .info-item {
            margin: 15px 0;
        }
        
        .info-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .info-item input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 10px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .submit-section {
            text-align: center;
            margin-top: 50px;
            margin-bottom: 30px;
        }
        
        .submit-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .submit-btn:hover {
            background-color: #2980b9;
        }
        
        .conclusion {
            background-color: #d4edda;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
            color: #155724;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .matrix-table th,
            .matrix-table td {
                padding: 10px;
                min-width: 100px;
            }
            
            .matrix-table input {
                width: 60px;
            }
            
            .radio-group {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>区域应急科普能力评价体系权重专家打分问卷</h1>
        <h2>（用于模糊层次分析法）</h2>
        
        <div class="instructions">
            <h3>尊敬的专家：</h3>
            <p>您好！为科学确定"区域应急科普能力综合评价"体系中各要素的权重，特邀请您参与本次两两比较打分。</p>
            <p>请您根据专业经验，对每组要素的相对重要性进行判断，采用 Saaty 1~9 标度法（见下表），并在对应空格填入数值。矩阵对角线恒为1，对称位置会自动计算倒数。</p>
            <p><strong>填写说明：</strong>请根据行项目与列项目的相对重要性进行打分，只需要填写矩阵上半部分（对角线以上）的空格即可。</p>
            
            <h3>标度含义</h3>
            <table class="scale-table">
                <tr>
                    <th>分值</th>
                    <th>含义</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>两者同等重要</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>行项目比列项目稍重要</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>行项目比列项目明显重要</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>行项目比列项目强烈重要</td>
                </tr>
                <tr>
                    <td>9</td>
                    <td>行项目比列项目极端重要</td>
                </tr>
                <tr>
                    <td>2,4,6,8</td>
                    <td>介于上述相邻值之间</td>
                </tr>
                <tr>
                    <td>1/3, 1/5, …</td>
                    <td>列项目比行项目重要的对应倒数</td>
                </tr>
            </table>
        </div>
        
        <form id="questionnaire-form">
            <!-- 第一部分：A–B 准则层两两比较矩阵 -->
            <h2>第一部分：A–B 准则层两两比较矩阵</h2>
            <p>比较目标：A（区域应急科普能力综合评价）下的 4 个准则 B1 组织保障、B2 资源建设、B3 活动开展、B4 社会效果的重要性。</p>
            
            <div class="matrix-container">
                <table class="matrix-table">
                    <tr>
                        <th>比较项目</th>
                        <th>B1组织保障</th>
                        <th>B2资源建设</th>
                        <th>B3活动开展</th>
                        <th>B4社会效果</th>
                    </tr>
                    <tr>
                        <th>B1组织保障</th>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="B1-B2" placeholder="请填写"></td>
                        <td><input type="text" name="B1-B3" placeholder="请填写"></td>
                        <td><input type="text" name="B1-B4" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>B2资源建设</th>
                        <td><input type="text" name="B2-B1" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="B2-B3" placeholder="请填写"></td>
                        <td><input type="text" name="B2-B4" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>B3活动开展</th>
                        <td><input type="text" name="B3-B1" placeholder="请填写"></td>
                        <td><input type="text" name="B3-B2" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="B3-B4" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>B4社会效果</th>
                        <td><input type="text" name="B4-B1" placeholder="请填写"></td>
                        <td><input type="text" name="B4-B2" placeholder="请填写"></td>
                        <td><input type="text" name="B4-B3" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                    </tr>
                </table>
            </div>
            
            <!-- 第二部分：B1–C 指标层两两比较矩阵 -->
            <h2>第二部分：B1–C 指标层两两比较矩阵</h2>
            <p>比较目标：B1 组织保障下的 C1~C4 重要性</p>
            
            <div class="matrix-container">
                <table class="matrix-table">
                    <tr>
                        <th>比较项目</th>
                        <th>C1组织架构完善程度</th>
                        <th>C2制度建设健全程度</th>
                        <th>C3经费投入充足程度</th>
                        <th>C4人员配备专业程度</th>
                    </tr>
                    <tr>
                        <th>C1组织架构完善程度</th>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C1-C2" placeholder="请填写"></td>
                        <td><input type="text" name="C1-C3" placeholder="请填写"></td>
                        <td><input type="text" name="C1-C4" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C2制度建设健全程度</th>
                        <td><input type="text" name="C2-C1" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C2-C3" placeholder="请填写"></td>
                        <td><input type="text" name="C2-C4" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C3经费投入充足程度</th>
                        <td><input type="text" name="C3-C1" placeholder="请填写"></td>
                        <td><input type="text" name="C3-C2" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C3-C4" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C4人员配备专业程度</th>
                        <td><input type="text" name="C4-C1" placeholder="请填写"></td>
                        <td><input type="text" name="C4-C2" placeholder="请填写"></td>
                        <td><input type="text" name="C4-C3" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                    </tr>
                </table>
            </div>
            
            <!-- 第三部分：B2–C 指标层两两比较矩阵 -->
            <h2>第三部分：B2–C 指标层两两比较矩阵</h2>
            <p>比较目标：B2 资源建设下的 C5~C8 重要性</p>
            
            <div class="matrix-container">
                <table class="matrix-table">
                    <tr>
                        <th>比较项目</th>
                        <th>C5科普设施便利性</th>
                        <th>C6宣传材料丰富性</th>
                        <th>C7宣传队伍专业性</th>
                        <th>C8信息化平台便利性</th>
                    </tr>
                    <tr>
                        <th>C5科普设施便利性</th>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C5-C6" placeholder="请填写"></td>
                        <td><input type="text" name="C5-C7" placeholder="请填写"></td>
                        <td><input type="text" name="C5-C8" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C6宣传材料丰富性</th>
                        <td><input type="text" name="C6-C5" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C6-C7" placeholder="请填写"></td>
                        <td><input type="text" name="C6-C8" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C7宣传队伍专业性</th>
                        <td><input type="text" name="C7-C5" placeholder="请填写"></td>
                        <td><input type="text" name="C7-C6" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C7-C8" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C8信息化平台便利性</th>
                        <td><input type="text" name="C8-C5" placeholder="请填写"></td>
                        <td><input type="text" name="C8-C6" placeholder="请填写"></td>
                        <td><input type="text" name="C8-C7" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                    </tr>
                </table>
            </div>
            
            <!-- 第四部分：B3–C 指标层两两比较矩阵 -->
            <h2>第四部分：B3–C 指标层两两比较矩阵</h2>
            <p>比较目标：B3 活动开展下的 C9~C12 重要性</p>
            
            <div class="matrix-container">
                <table class="matrix-table">
                    <tr>
                        <th>比较项目</th>
                        <th>C9科普宣传活动</th>
                        <th>C10应急演练</th>
                        <th>C11应急培训</th>
                        <th>C12宣传渠道</th>
                    </tr>
                    <tr>
                        <th>C9科普宣传活动</th>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C9-C10" placeholder="请填写"></td>
                        <td><input type="text" name="C9-C11" placeholder="请填写"></td>
                        <td><input type="text" name="C9-C12" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C10应急演练</th>
                        <td><input type="text" name="C10-C9" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C10-C11" placeholder="请填写"></td>
                        <td><input type="text" name="C10-C12" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C11应急培训</th>
                        <td><input type="text" name="C11-C9" placeholder="请填写"></td>
                        <td><input type="text" name="C11-C10" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C11-C12" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C12宣传渠道</th>
                        <td><input type="text" name="C12-C9" placeholder="请填写"></td>
                        <td><input type="text" name="C12-C10" placeholder="请填写"></td>
                        <td><input type="text" name="C12-C11" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                    </tr>
                </table>
            </div>
            
            <!-- 第五部分：B4–C 指标层两两比较矩阵 -->
            <h2>第五部分：B4–C 指标层两两比较矩阵</h2>
            <p>比较目标：B4 社会效果下的 C13~C15 重要性</p>
            
            <div class="matrix-container">
                <table class="matrix-table">
                    <tr>
                        <th>比较项目</th>
                        <th>C13公众知晓率</th>
                        <th>C14技能掌握度</th>
                        <th>C15社会满意度</th>
                    </tr>
                    <tr>
                        <th>C13公众知晓率</th>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C13-C14" placeholder="请填写"></td>
                        <td><input type="text" name="C13-C15" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C14技能掌握度</th>
                        <td><input type="text" name="C14-C13" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                        <td><input type="text" name="C14-C15" placeholder="请填写"></td>
                    </tr>
                    <tr>
                        <th>C15社会满意度</th>
                        <td><input type="text" name="C15-C13" placeholder="请填写"></td>
                        <td><input type="text" name="C15-C14" placeholder="请填写"></td>
                        <td class="fixed-value">1</td>
                    </tr>
                </table>
            </div>
            
            <!-- 第六部分：专家基本信息 -->
            <h2>第六部分：专家基本信息</h2>
            
            <div class="info-section">
                <div class="info-item">
                    <label for="name">1. 姓名（可选）：</label>
                    <input type="text" id="name" name="name" placeholder="请输入姓名">
                </div>
                
                <div class="info-item">
                    <label>2. 专业领域：</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="field-em" name="field" value="应急管理">
                            <label for="field-em">应急管理</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="field-ps" name="field" value="公共安全">
                            <label for="field-ps">公共安全</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="field-ep" name="field" value="教育科普">
                            <label for="field-ep">教育科普</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="field-ss" name="field" value="社会科学">
                            <label for="field-ss">社会科学</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="field-other" name="field" value="其他">
                            <label for="field-other">其他</label>
                            <input type="text" id="field-other-text" name="field-other-text" placeholder="请说明">
                        </div>
                    </div>
                </div>
                
                <div class="info-item">
                    <label>3. 职称（可选）：</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="title-senior" name="title" value="正高级">
                            <label for="title-senior">正高级</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="title-associate" name="title" value="副高级">
                            <label for="title-associate">副高级</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="title-intermediate" name="title" value="中级">
                            <label for="title-intermediate">中级</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="title-junior" name="title" value="初级">
                            <label for="title-junior">初级</label>
                        </div>
                    </div>
                </div>
                
                <div class="info-item">
                    <label>4. 相关工作年限：</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="exp-less5" name="experience" value="&lt;5年">
                            <label for="exp-less5">&lt;5年</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="exp-5-10" name="experience" value="5–10年">
                            <label for="exp-5-10">5–10年</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="exp-10-20" name="experience" value="10–20年">
                            <label for="exp-10-20">10–20年</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="exp-more20" name="experience" value="&gt;20年">
                            <label for="exp-more20">&gt;20年</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 结束语 -->
            <div class="conclusion">
                <h3>【结束语】</h3>
                <p>感谢您在百忙之中参与本次专家打分！您的判断将对区域应急科普能力评价体系的科学性起到关键作用。我们将对数据进行一致性检验，并结合多位专家结果计算最终权重。</p>
            </div>
            
            <!-- 提交按钮 -->
            <div class="submit-section">
                <button type="submit" class="submit-btn">提交问卷</button>
            </div>
        </form>
    </div>
    
    <script>
        // 自动计算倒数功能
        function setupReciprocalCalculation() {
            // 定义矩阵关系对
            const matrixPairs = [
                // A-B矩阵
                ['B1-B2', 'B2-B1'],
                ['B1-B3', 'B3-B1'],
                ['B1-B4', 'B4-B1'],
                ['B2-B3', 'B3-B2'],
                ['B2-B4', 'B4-B2'],
                ['B3-B4', 'B4-B3'],
                
                // B1-C矩阵
                ['C1-C2', 'C2-C1'],
                ['C1-C3', 'C3-C1'],
                ['C1-C4', 'C4-C1'],
                ['C2-C3', 'C3-C2'],
                ['C2-C4', 'C4-C2'],
                ['C3-C4', 'C4-C3'],
                
                // B2-C矩阵
                ['C5-C6', 'C6-C5'],
                ['C5-C7', 'C7-C5'],
                ['C5-C8', 'C8-C5'],
                ['C6-C7', 'C7-C6'],
                ['C6-C8', 'C8-C6'],
                ['C7-C8', 'C8-C7'],
                
                // B3-C矩阵
                ['C9-C10', 'C10-C9'],
                ['C9-C11', 'C11-C9'],
                ['C9-C12', 'C12-C9'],
                ['C10-C11', 'C11-C10'],
                ['C10-C12', 'C12-C10'],
                ['C11-C12', 'C12-C11'],
                
                // B4-C矩阵
                ['C13-C14', 'C14-C13'],
                ['C13-C15', 'C15-C13'],
                ['C14-C15', 'C15-C14']
            ];
            
            // 为下半部分输入框设置只读
            matrixPairs.forEach(([upper, lower]) => {
                const lowerInput = document.querySelector(`input[name="${lower}"]`);
                if (lowerInput) {
                    lowerInput.readOnly = true;
                    lowerInput.style.backgroundColor = '#f8f9fa';
                }
            });
            
            // 添加事件监听器
            matrixPairs.forEach(([upper, lower]) => {
                const upperInput = document.querySelector(`input[name="${upper}"]`);
                const lowerInput = document.querySelector(`input[name="${lower}"]`);
                
                if (upperInput && lowerInput) {
                    upperInput.addEventListener('input', function() {
                        const value = this.value.trim();
                        if (value === '') {
                            lowerInput.value = '';
                            return;
                        }
                        
                        // 计算倒数
                        try {
                            const numValue = parseFloat(value);
                            if (!isNaN(numValue) && numValue > 0) {
                                const reciprocal = 1 / numValue;
                                // 格式化输出
                                if (reciprocal === Math.floor(reciprocal)) {
                                    lowerInput.value = reciprocal.toString();
                                } else if (reciprocal < 1) {
                                    lowerInput.value = `1/${Math.round(1/reciprocal)}`;
                                } else {
                                    lowerInput.value = reciprocal.toFixed(2);
                                }
                            } else if (value.includes('/')) {
                                // 处理分数输入
                                const parts = value.split('/');
                                if (parts.length === 2) {
                                    const numerator = parseFloat(parts[0]);
                                    const denominator = parseFloat(parts[1]);
                                    if (!isNaN(numerator) && !isNaN(denominator) && denominator > 0) {
                                        lowerInput.value = `${denominator}/${numerator}`;
                                    }
                                }
                            }
                        } catch (e) {
                            console.error('计算倒数时出错:', e);
                        }
                    });
                }
            });
        }
        
        // 表单提交处理
        document.getElementById('questionnaire-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 收集表单数据
            const formData = new FormData(this);
            const data = {};
            
            formData.forEach((value, key) => {
                data[key] = value;
            });
            
            // 简单验证
            let isValid = true;
            let missingFields = [];
            
            // 验证矩阵填写（只验证上半部分）
            const upperMatrixFields = [
                // A-B矩阵
                'B1-B2', 'B1-B3', 'B1-B4', 'B2-B3', 'B2-B4', 'B3-B4',
                
                // B1-C矩阵
                'C1-C2', 'C1-C3', 'C1-C4', 'C2-C3', 'C2-C4', 'C3-C4',
                
                // B2-C矩阵
                'C5-C6', 'C5-C7', 'C5-C8', 'C6-C7', 'C6-C8', 'C7-C8',
                
                // B3-C矩阵
                'C9-C10', 'C9-C11', 'C9-C12', 'C10-C11', 'C10-C12', 'C11-C12',
                
                // B4-C矩阵
                'C13-C14', 'C13-C15', 'C14-C15'
            ];
            
            upperMatrixFields.forEach(field => {
                if (!data[field] || data[field].trim() === '') {
                    isValid = false;
                    missingFields.push(field);
                }
            });
            
            if (!isValid) {
                alert('请填写所有矩阵中的空白字段！');
                return;
            }
            
            // 验证专业领域
            if (!data.field) {
                alert('请选择专业领域！');
                return;
            }
            
            // 验证工作年限
            if (!data.experience) {
                alert('请选择相关工作年限！');
                return;
            }
            
            // 生成JSON文件并下载
            const jsonData = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `expert_questionnaire_${new Date().toISOString().slice(0,10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('问卷提交成功！请将下载的JSON文件发送给我们，感谢您的参与！');
        });
        
        // 其他专业领域文本框显示/隐藏
        document.getElementById('field-other').addEventListener('change', function() {
            const otherText = document.getElementById('field-other-text');
            if (this.checked) {
                otherText.style.display = 'inline-block';
                otherText.required = true;
            } else {
                otherText.style.display = 'none';
                otherText.required = false;
            }
        });
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            setupReciprocalCalculation();
            document.getElementById('field-other-text').style.display = 'none';
            // 设置时间戳
            const timestampInput = document.getElementById('timestamp');
            if (timestampInput) {
                timestampInput.value = new Date().toISOString();
            }
        });
    </script>
</body>
</html>